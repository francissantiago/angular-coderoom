
<div class="h-full w-full bg-[#1e1e1e] flex flex-col rounded-lg overflow-hidden">
  <!-- Header -->
  <div class="flex-shrink-0 bg-[#3c3c3c] px-4 py-2 text-sm font-medium text-gray-300 flex items-center border-b border-gray-700">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-purple-400" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd" />
    </svg>
    Chat da Turma
  </div>

  <!-- Messages -->
  <div #chatContainer class="flex-grow p-4 space-y-4 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-transparent">
    @for (message of messages(); track message.timestamp) {
      <div class="flex" [class]="message.sender === role() ? 'justify-end' : 'justify-start'">
        <div class="max-w-[85%] px-4 py-2 rounded-lg shadow-sm" [class]="message.sender === role() ? 'bg-blue-600 text-white' : 'bg-gray-600 text-gray-200'">
          <div class="flex items-baseline gap-2 mb-1">
            <p class="font-bold text-xs opacity-90">{{ message.sender === 'Student' ? 'Aluno' : 'Professor' }}</p>
            <p class="text-[10px] opacity-70">{{ formatTimestamp(message.timestamp) }}</p>
          </div>
          <p class="text-sm break-words leading-relaxed">{{ message.text }}</p>
        </div>
      </div>
    }
  </div>

  <!-- Input Form -->
  <div class="flex-shrink-0 p-2 border-t border-gray-700 bg-[#252526]">
    <form (submit)="$event.preventDefault(); sendMessage()" class="flex items-center gap-2">
      <input
        type="text"
        placeholder="Digite sua mensagem..."
        class="flex-grow bg-[#3c3c3c] border border-gray-600 rounded-md px-3 py-2 text-sm text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow"
        [value]="newMessage()"
        (input)="handleInput($event)"
        aria-label="Chat message input"
      >
      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md text-sm transition-colors" [disabled]="!newMessage().trim()">
        Enviar
      </button>
    </form>
  </div>
</div>
